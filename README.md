# clash-verge&Flclash&mihomo.js æ™ºèƒ½åˆ†æµé…ç½®è„šæœ¬ - ä½¿ç”¨è¯´æ˜Ž

## ðŸ“– ç®€ä»‹

- **clash-verge&flclash&mihomo.js**ï¼šæ˜¯ä¸€ä¸ªä¸“ä¸º mihomoï¼ˆClash å˜ç§ï¼‰è®¾è®¡çš„**æ™ºèƒ½åˆ†æµé…ç½®è„šæœ¬**
- **singboxå…¨è‡ªåŠ¨èŠ‚ç‚¹åˆ†æµç®¡ç†æ’ä»¶.js**ï¼šæ˜¯ç»™singboxåšçš„ä¸€ä¸ªå…¨è‡ªåŠ¨èŠ‚ç‚¹çš„ç®¡ç†ä¸Žåˆ†æµçš„æ’ä»¶ã€‚
- **singboxå…¨è‡ªåŠ¨èŠ‚ç‚¹åˆ†æµç®¡ç†æ··å…¥è„šæœ¬.js**ï¼šæ˜¯ç»™singboxåšçš„ä¸€ä¸ªå…¨è‡ªåŠ¨èŠ‚ç‚¹çš„ç®¡ç†ä¸Žåˆ†æµçš„é…ç½®æ··å…¥è„šæœ¬ã€‚
- **ä¸Šè¿°ä¸‰ä¸ªè„šæœ¬çš„é€»è¾‘ä¸ŽåŠŸèƒ½éƒ½æ˜¯å‡ºè‡ªåŒæºé€»è¾‘ï¼Œåªæ˜¯é’ˆå¯¹å„è‡ªçš„é€‚ç”¨åœºæ™¯åšäº†åˆ†åˆ«çš„ä¼˜åŒ–ä¸Žé€‚é…ã€‚**
- **å®ƒä»¬éƒ½èƒ½å¤Ÿè‡ªåŠ¨ç®¡ç†æ‚¨çš„ä»£ç†èŠ‚ç‚¹ï¼Œæ ¹æ®ç½‘ç»œè´¨é‡ã€åœ°ç†ä½ç½®å’Œè®¿é—®éœ€æ±‚ï¼Œæ™ºèƒ½é€‰æ‹©æœ€ä½³èŠ‚ç‚¹ï¼Œè®©æ‚¨çš„ç½‘ç»œè®¿é—®æ›´åŠ æµç•…ã€ç¨³å®šã€‚**


## ðŸ“‹ ç›®å½•

- [æ ¸å¿ƒç‰¹æ€§](#æ ¸å¿ƒç‰¹æ€§)
- [ç³»ç»Ÿæž¶æž„](#ç³»ç»Ÿæž¶æž„)
- [å®‰è£…ä¸Žä½¿ç”¨](#å®‰è£…ä¸Žä½¿ç”¨)
- [é…ç½®è¯´æ˜Ž](#é…ç½®è¯´æ˜Ž)
- [æ ¸å¿ƒç»„ä»¶](#æ ¸å¿ƒç»„ä»¶)
- [æ™ºèƒ½è·¯ç”±ç®—æ³•](#æ™ºèƒ½è·¯ç”±ç®—æ³•)
- [æ€§èƒ½ç›‘æŽ§](#æ€§èƒ½ç›‘æŽ§)
- [å®‰å…¨ç‰¹æ€§](#å®‰å…¨ç‰¹æ€§)
- [API æŽ¥å£](#api-æŽ¥å£)
- [æ•…éšœæŽ’é™¤](#æ•…éšœæŽ’é™¤)
- [å¼€å‘æŒ‡å—](#å¼€å‘æŒ‡å—)

## ðŸš€ æ ¸å¿ƒç‰¹æ€§

### æ™ºèƒ½èŠ‚ç‚¹ç®¡ç†
- **å¤šæŒ‡æ ‡è¯„ä¼°**ï¼šåŸºäºŽå»¶è¿Ÿã€æŠ–åŠ¨ã€ä¸¢åŒ…çŽ‡ã€åžåé‡ç­‰ç»¼åˆæŒ‡æ ‡è¿›è¡ŒèŠ‚ç‚¹è´¨é‡è¯„åˆ†
- **AI é©±åŠ¨é¢„æµ‹**ï¼šä½¿ç”¨æœºå™¨å­¦ä¹ ç®—æ³•é¢„æµ‹èŠ‚ç‚¹æœªæ¥æ€§èƒ½è¡¨çŽ°
- **è‡ªé€‚åº”é˜ˆå€¼**ï¼šæ ¹æ®ç½‘ç»œçŽ¯å¢ƒåŠ¨æ€è°ƒæ•´ä¼˜åŠ£èŠ‚ç‚¹åˆ†ç±»æ ‡å‡†
- **æ•…éšœè½¬ç§»**ï¼šè‡ªåŠ¨æ£€æµ‹èŠ‚ç‚¹æ•…éšœå¹¶åˆ‡æ¢åˆ°æœ€ä½³å¯ç”¨èŠ‚ç‚¹

### æ™ºèƒ½è·¯ç”±é€‰æ‹©
- **åœ°ç†è·¯ç”±**ï¼šæ ¹æ®ç›®æ ‡æœåŠ¡å™¨åœ°ç†ä½ç½®æ™ºèƒ½é€‰æ‹©æœ€ä¼˜èŠ‚ç‚¹
- **ä¸šåŠ¡æ„ŸçŸ¥**ï¼šé’ˆå¯¹è§†é¢‘æµã€æ¸¸æˆã€AI æœåŠ¡ç­‰ä¸åŒåœºæ™¯ä¼˜åŒ–èŠ‚ç‚¹é€‰æ‹©
- **åŒºåŸŸåˆ†ç»„**ï¼šè‡ªåŠ¨è¯†åˆ«å’Œåˆ†ç»„ä¸åŒåœ°åŒºçš„èŠ‚ç‚¹ï¼Œæ”¯æŒåŒä¹‰è¯æ˜ å°„
- **ç¼“å­˜ä¼˜åŒ–**ï¼šå¤šå±‚ç¼“å­˜æœºåˆ¶æå‡è·¯ç”±å†³ç­–é€Ÿåº¦

### æ€§èƒ½ä¼˜åŒ–
- **å¹¶å‘æ± è°ƒåº¦**ï¼šé«˜æ•ˆçš„ä»»åŠ¡å¹¶å‘æ‰§è¡Œæœºåˆ¶
- **é¢„çƒ­æœºåˆ¶**ï¼šç³»ç»Ÿå¯åŠ¨æ—¶é¢„å…ˆæµ‹è¯•èŠ‚ç‚¹æ€§èƒ½
- **LRU ç¼“å­˜**ï¼šæ™ºèƒ½ç¼“å­˜ç®¡ç†ï¼Œé˜²æŠ–æ¸…ç†æœºåˆ¶
- **èµ„æºç›‘æŽ§**ï¼šå®žæ—¶ç›‘æŽ§ç³»ç»Ÿèµ„æºä½¿ç”¨æƒ…å†µ

### å®‰å…¨é˜²æŠ¤
- **SSRF é˜²æŠ¤**ï¼šé˜»æ­¢è®¿é—®å†…ç½‘å’Œå›žçŽ¯åœ°å€
- **URL å®‰å…¨åŒ–**ï¼šè‡ªåŠ¨è¿‡æ»¤å’ŒéªŒè¯è¯·æ±‚ URL
- **é‡å®šå‘å®¡è®¡**ï¼šé€è·³é‡å®šå‘å®‰å…¨æ£€æŸ¥
- **éšç§ä¿æŠ¤**ï¼šå¯é€‰çš„åœ°ç†ä½ç½®æŸ¥è¯¢å¼€å…³

## ðŸ—ï¸ ç³»ç»Ÿæž¶æž„

```mermaid
graph TB
    A[Client Request] --> B[Central Manager]
    B --> C[Request Analysis]
    C --> D[Geo Routing]
    C --> E[Business Context]
    D --> F[Node Manager]
    E --> F
    F --> G[Node Pools]
    F --> H[Quality Scoring]
    G --> I[Best Node Selection]
    H --> I
    I --> J[Proxy Execution]
    J --> K[Response Metrics]
    K --> L[AI Learning]
    L --> F
```

### æ ¸å¿ƒæ¨¡å—

1. **CentralManager**ï¼šä¸­å¤®æŽ§åˆ¶å™¨ï¼Œç»Ÿç­¹æ‰€æœ‰åŠŸèƒ½æ¨¡å—
2. **NodeManager**ï¼šèŠ‚ç‚¹ç®¡ç†å™¨ï¼Œè´Ÿè´£èŠ‚ç‚¹é€‰æ‹©å’Œåˆ‡æ¢
3. **RegionAutoManager**ï¼šåŒºåŸŸè‡ªåŠ¨ç®¡ç†å™¨ï¼Œå¤„ç†åœ°ç†åˆ†ç»„
4. **AdBlockManager**ï¼šå¹¿å‘Šæ‹¦æˆªç®¡ç†å™¨ï¼Œè‡ªåŠ¨æ›´æ–°è§„åˆ™
5. **MetricsManager**ï¼šæŒ‡æ ‡ç®¡ç†å™¨ï¼Œæ”¶é›†å’Œåˆ†æžæ€§èƒ½æ•°æ®
6. **AvailabilityTracker**ï¼šå¯ç”¨æ€§è·Ÿè¸ªå™¨ï¼Œç›‘æŽ§èŠ‚ç‚¹çŠ¶æ€

## ðŸ› ï¸ å®‰è£…ä¸Žä½¿ç”¨

### çŽ¯å¢ƒè¦æ±‚
- **Node.js** >= 14.0.0 (æŽ¨è 16.0.0+)
- **çŽ°ä»£æµè§ˆå™¨**ï¼šæ”¯æŒ fetch API å’Œ AbortController
- **å†…å­˜**ï¼šå»ºè®®è‡³å°‘ 512MB å¯ç”¨å†…å­˜
- **ç½‘ç»œ**ï¼šç¨³å®šçš„äº’è”ç½‘è¿žæŽ¥

### åŸºæœ¬ä½¿ç”¨

```javascript
// å¯¼å…¥æ¨¡å—
const { main, CentralManager, Config } = require('./mihomoTareAIcopy4.js');

// åŸºç¡€é…ç½®
const config = {
  proxies: [
    { name: "é¦™æ¸¯èŠ‚ç‚¹1", type: "ss", server: "hk1.example.com", port: 443, cipher: "aes-256-gcm", password: "your-password" },
    { name: "ç¾Žå›½èŠ‚ç‚¹1", type: "vmess", server: "us1.example.com", port: 443, uuid: "your-uuid" }
  ]
};

// å¤„ç†é…ç½®
const processedConfig = main(config);
console.log('å¤„ç†åŽçš„é…ç½®:', processedConfig);
```

### é«˜çº§é…ç½®

```javascript
// è‡ªå®šä¹‰é…ç½®
const customConfig = {
  enable: true,
  privacy: {
    geoExternalLookup: true,          // å¯ç”¨åœ°ç†ä½ç½®æŸ¥è¯¢
    githubMirrorEnabled: true,         // å¯ç”¨ GitHub é•œåƒ
    trustedGeoEndpoints: [             // è‡ªå®šä¹‰åœ°ç†ä½ç½®æŸ¥è¯¢ç«¯ç‚¹
      "https://ipapi.co/json/{ip}",
      "https://geo.ipify.org/api/v1?ip={ip}"
    ]
  },
  tuning: {
    preheatEnabled: true,              // å¯ç”¨èŠ‚ç‚¹é¢„çƒ­
    preheatConcurrency: 5,              // é¢„çƒ­å¹¶å‘æ•°
    nodeTestTimeoutMs: 3000,            // èŠ‚ç‚¹æµ‹è¯•è¶…æ—¶
    nodeTestMaxAttempts: 5              // æœ€å¤§æµ‹è¯•é‡è¯•æ¬¡æ•°
  }
};
```

## âš™ï¸ é…ç½®è¯´æ˜Ž

### åŸºç¡€é…ç½®é¡¹

| é…ç½®é¡¹ | ç±»åž‹ | é»˜è®¤å€¼ | è¯´æ˜Ž |
|--------|------|--------|------|
| `enable` | boolean | true | æ˜¯å¦å¯ç”¨æ™ºèƒ½è·¯ç”± |
| `privacy.geoExternalLookup` | boolean | false | æ˜¯å¦å¯ç”¨å¤–éƒ¨åœ°ç†ä½ç½®æŸ¥è¯¢ |
| `privacy.githubMirrorEnabled` | boolean | false | æ˜¯å¦å¯ç”¨ GitHub é•œåƒåŠ é€Ÿ |
| `regionOptions.ratioLimit` | number | 2 | èŠ‚ç‚¹å€çŽ‡é™åˆ¶ |
| `tuning.preheatEnabled` | boolean | true | æ˜¯å¦å¯ç”¨èŠ‚ç‚¹é¢„çƒ­ |

### èŠ‚ç‚¹é…ç½®ç¤ºä¾‹

```yaml
proxies:
  - name: "é¦™æ¸¯-01"
    type: ss
    server: hk1.example.com
    port: 443
    cipher: aes-256-gcm
    password: your-password
    
  - name: "ç¾Žå›½-01"
    type: vmess
    server: us1.example.com
    port: 443
    uuid: your-uuid
    alterId: 0
    cipher: auto
    
  - name: "æ—¥æœ¬-01"
    type: trojan
    server: jp1.example.com
    port: 443
    password: your-password
    sni: jp1.example.com
```

### æœåŠ¡è§„åˆ™é…ç½®

ç³»ç»Ÿé¢„è®¾äº†ä¸°å¯Œçš„æœåŠ¡è§„åˆ™ï¼ŒåŒ…æ‹¬ï¼š
- **æµåª’ä½“æœåŠ¡**ï¼šYouTubeã€Netflixã€Disney+ã€Bilibili ç­‰
- **AI æœåŠ¡**ï¼šOpenAIã€Claudeã€Gemini ç­‰
- **ç¤¾äº¤åº”ç”¨**ï¼šTelegramã€WhatsAppã€Line ç­‰
- **æ¸¸æˆæœåŠ¡**ï¼šä¸“ç”¨æ¸¸æˆä»£ç†é€šé“
- **å¹¿å‘Šæ‹¦æˆª**ï¼šé›†æˆå¤šæºå¹¿å‘Šè§„åˆ™

## ðŸ§© æ ¸å¿ƒç»„ä»¶

### CentralManager

ä¸­å¤®ç®¡ç†å™¨æ˜¯æ•´ä¸ªç³»ç»Ÿçš„æ ¸å¿ƒï¼Œè´Ÿè´£åè°ƒå„ä¸ªæ¨¡å—ï¼š

```javascript
const manager = CentralManager.getInstance();

// å¤„ç†è¯·æ±‚
const result = await manager.onRequestOutbound({
  url: "https://www.youtube.com",
  method: "GET",
  headers: {},
  user: "user1"
});

console.log('è·¯ç”±ç»“æžœ:', result);
```

### NodeManager

èŠ‚ç‚¹ç®¡ç†å™¨è´Ÿè´£èŠ‚ç‚¹çš„é€‰æ‹©ã€åˆ‡æ¢å’Œè´¨é‡è¯„åˆ†ï¼š

```javascript
const nodeManager = NodeManager.getInstance();

// èŽ·å–æœ€ä½³èŠ‚ç‚¹
const bestNode = await nodeManager.getBestNode(proxies, { country: "United States" });

// åˆ‡æ¢åˆ°æŒ‡å®šèŠ‚ç‚¹
await nodeManager.switchToNode("node-id", { country: "Hong Kong" });
```

### RegionAutoManager

åŒºåŸŸè‡ªåŠ¨ç®¡ç†å™¨å¤„ç†èŠ‚ç‚¹çš„åœ°ç†åˆ†ç»„ï¼š

```javascript
const regionManager = new RegionAutoManager();

// å‘çŽ°æ–°åŒºåŸŸ
const discovered = regionManager.discoverRegionsFromProxies(proxies);

// æž„å»ºåŒºåŸŸåˆ†ç»„
const { regionProxyGroups } = regionManager.buildRegionGroups(config, regions);
```

## ðŸ§  æ™ºèƒ½è·¯ç”±ç®—æ³•

### èŠ‚ç‚¹è´¨é‡è¯„åˆ†ç®—æ³•

ç³»ç»Ÿé‡‡ç”¨å¤šç»´åº¦è¯„åˆ†æœºåˆ¶ï¼š

```javascript
// è¯„åˆ†æƒé‡é…ç½®
const weights = {
  quality: 0.5,        // åŽ†å²è´¨é‡è¯„åˆ†
  metrics: 0.35,       // å®žæ—¶æ€§èƒ½æŒ‡æ ‡
  success: 0.15         // æˆåŠŸçŽ‡æƒé‡
};

// ç»¼åˆè¯„åˆ†è®¡ç®—
const score = (quality * weights.quality) + 
             (metricScore * weights.metrics) + 
             (successRate * weights.success);
```

### ä¸šåŠ¡æ„ŸçŸ¥è·¯ç”±

æ ¹æ®ä¸åŒä¸šåŠ¡åœºæ™¯ä¼˜åŒ–èŠ‚ç‚¹é€‰æ‹©ï¼š

- **è§†é¢‘æµ**ï¼šä¼˜å…ˆé€‰æ‹©é«˜åžåé‡èŠ‚ç‚¹
- **æ¸¸æˆåº”ç”¨**ï¼šä¼˜å…ˆé€‰æ‹©ä½Žå»¶è¿Ÿã€ä½ŽæŠ–åŠ¨èŠ‚ç‚¹
- **AI æœåŠ¡**ï¼šä¼˜å…ˆé€‰æ‹©ç¨³å®šæ€§å’ŒæˆåŠŸçŽ‡é«˜çš„èŠ‚ç‚¹
- **å¤§æ–‡ä»¶ä¸‹è½½**ï¼šä¼˜å…ˆé€‰æ‹©é«˜å¸¦å®½èŠ‚ç‚¹

### åœ°ç†è·¯ç”±ä¼˜åŒ–

```javascript
// åŒºåŸŸåŒä¹‰è¯æ˜ å°„
const REGION_SYNONYMS = {
  "Hong Kong": ["Hong Kong", "HK", "é¦™æ¸¯"],
  "United States": ["United States", "US", "USA", "ç¾Žå›½"],
  "Japan": ["Japan", "JP", "æ—¥æœ¬"]
};
```

## ðŸ“Š æ€§èƒ½ç›‘æŽ§

### å®žæ—¶æŒ‡æ ‡æ”¶é›†

ç³»ç»Ÿå®žæ—¶æ”¶é›†ä»¥ä¸‹æ€§èƒ½æŒ‡æ ‡ï¼š
- **å»¶è¿Ÿ (Latency)**ï¼šè¯·æ±‚å“åº”æ—¶é—´
- **æŠ–åŠ¨ (Jitter)**ï¼šå»¶è¿Ÿå˜åŒ–å¹…åº¦
- **ä¸¢åŒ…çŽ‡ (Loss)**ï¼šæ•°æ®åŒ…ä¸¢å¤±æ¯”ä¾‹
- **åžåé‡ (Throughput)**ï¼šæ•°æ®ä¼ è¾“é€ŸçŽ‡
- **æˆåŠŸçŽ‡ (Success Rate)**ï¼šè¯·æ±‚æˆåŠŸç™¾åˆ†æ¯”

### AI é¢„æµ‹æ¨¡åž‹

ä½¿ç”¨æœºå™¨å­¦ä¹ é¢„æµ‹èŠ‚ç‚¹æœªæ¥æ€§èƒ½ï¼š

```javascript
// ç‰¹å¾æå–
const features = extractNodeFeatures(node, currentMetrics, history);

// é£Žé™©è¯„ä¼°
const prediction = predictNodeFuturePerformance(features);

// åˆ†æ•°è°ƒæ•´
const adjustment = calculateScoreAdjustment(prediction, success);
```

### æ€§èƒ½ä¼˜åŒ–æœºåˆ¶

- **LRU ç¼“å­˜**ï¼šæ™ºèƒ½ç¼“å­˜è·¯ç”±å†³ç­–ç»“æžœ
- **é˜²æŠ–æ¸…ç†**ï¼šé¿å…é¢‘ç¹çš„ç¼“å­˜æ¸…ç†æ“ä½œ
- **å¹¶å‘æŽ§åˆ¶**ï¼šé™åˆ¶å¹¶å‘æµ‹è¯•æ•°é‡ï¼Œä¿æŠ¤ç³»ç»Ÿèµ„æº
- **é¢„çƒ­æœºåˆ¶**ï¼šç³»ç»Ÿå¯åŠ¨æ—¶é¢„å…ˆè¯„ä¼°èŠ‚ç‚¹æ€§èƒ½

## ðŸ”’ å®‰å…¨ç‰¹æ€§

### SSRF é˜²æŠ¤

```javascript
// å®‰å…¨ç«¯å£åˆ—è¡¨
const SAFE_PORTS = new Set([80, 443, 8080, 8081, 8088, 8880, 8443]);

// ç§ç½‘åœ°å€æ£€æµ‹
function isPrivateIP(ip) {
  const [a, b] = ip.split(".").map(n => parseInt(n, 10));
  return a === 10 || a === 127 || (a === 192 && b === 168) || (a === 172 && b >= 16 && b <= 31);
}
```

### URL å®‰å…¨åŒ–

- **åè®®è¿‡æ»¤**ï¼šä»…å…è®¸ HTTP/HTTPS åè®®
- **è‡ªåŠ¨å‡çº§**ï¼šHTTP è‡ªåŠ¨å‡çº§ä¸º HTTPS
- **é‡å®šå‘å®¡è®¡**ï¼šé€è·³æ£€æŸ¥é‡å®šå‘å®‰å…¨æ€§
- **Data URL é™åˆ¶**ï¼šé™åˆ¶å†…è”èµ„æºå¤§å°å’Œç±»åž‹

### éšç§ä¿æŠ¤

- **å¯é€‰åœ°ç†ä½ç½®æŸ¥è¯¢**ï¼šç”¨æˆ·å¯é€‰æ‹©æ˜¯å¦å¯ç”¨å¤–éƒ¨åœ°ç†ä½ç½®æœåŠ¡
- **æœ¬åœ°ç¼“å­˜**ï¼šåœ°ç†ä½ç½®ä¿¡æ¯æœ¬åœ°ç¼“å­˜ï¼Œå‡å°‘å¤–éƒ¨æŸ¥è¯¢
- **æ•°æ®è„±æ•**ï¼šæ•æ„Ÿä¿¡æ¯å¤„ç†å’Œå­˜å‚¨

## ðŸ”Œ API æŽ¥å£

### ä¸»è¦ API

```javascript
// å¤„ç†è¯·æ±‚
async handleProxyRequest(req, ...args)

// æ™ºèƒ½èŠ‚ç‚¹è°ƒåº¦
async smartDispatchNode(user, nodes, context)

// è¯·æ±‚å¤„ç†
async onRequestOutbound(reqCtx)

// å“åº”å¤„ç†
async onResponseInbound(resCtx)

// èŽ·å–åœ°ç†ä½ç½®
async getGeoInfo(ip, domain)

// åŸŸåè§£æž
async resolveDomainToIP(domain)
```

### é…ç½®å¤„ç†

```javascript
// å¤„ç†ä»£ç†é…ç½®
processConfiguration(config)

// ç”Ÿæˆä»£ç†ç»„
buildRegionGroups(config, regions)

// æ³¨å…¥è§„åˆ™æä¾›è€…
injectRuleProvider(ruleProviders)
```

### æ€§èƒ½æµ‹è¯•

```javascript
// å¤šæŒ‡æ ‡æµ‹è¯•
async testNodeMultiMetrics(node)

// TCP è¿žæŽ¥æµ‹è¯•
async tcpConnectLatency(host, port, timeout)

// åžåé‡æµ‹é‡
async measureResponse(response)
```

## ðŸ”§ æ•…éšœæŽ’é™¤

### å¸¸è§é—®é¢˜

1. **èŠ‚ç‚¹åˆ‡æ¢é¢‘ç¹**
   - æ£€æŸ¥ `AVAILABILITY_MIN_RATE` è®¾ç½®
   - è°ƒæ•´ `BASE_SWITCH_COOLDOWN` å‚æ•°
   - æŸ¥çœ‹èŠ‚ç‚¹è´¨é‡è¯„åˆ†é˜ˆå€¼

2. **æ€§èƒ½è¯„åˆ†å¼‚å¸¸**
   - æ£€æŸ¥èŠ‚ç‚¹æµ‹è¯•è¶…æ—¶è®¾ç½®
   - éªŒè¯èŠ‚ç‚¹è¿žé€šæ€§
   - æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—è¾“å‡º

3. **åœ°ç†ä½ç½®æŸ¥è¯¢å¤±è´¥**
   - æ£€æŸ¥ç½‘ç»œè¿žæŽ¥
   - éªŒè¯ `trustedGeoEndpoints` é…ç½®
   - æ£€æŸ¥é˜²ç«å¢™è®¾ç½®

### è°ƒè¯•æ¨¡å¼

```javascript
// å¯ç”¨è°ƒè¯•æ—¥å¿—
const CONSTANTS = {
  ENABLE_SCORE_DEBUGGING: true
};

// æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
Logger.debug("Central.debug", "è°ƒè¯•ä¿¡æ¯", data);
```

### æ—¥å¿—çº§åˆ«

- `ERROR`ï¼šé”™è¯¯ä¿¡æ¯ï¼Œéœ€è¦ç«‹å³å…³æ³¨
- `WARN`ï¼šè­¦å‘Šä¿¡æ¯ï¼Œå¯èƒ½å½±å“åŠŸèƒ½
- `INFO`ï¼šä¸€èˆ¬ä¿¡æ¯ï¼Œæ­£å¸¸è¿è¡ŒçŠ¶æ€
- `DEBUG`ï¼šè°ƒè¯•ä¿¡æ¯ï¼Œä»…åœ¨è°ƒè¯•æ¨¡å¼ä¸‹æ˜¾ç¤º

## ðŸ‘¨â€ðŸ’» å¼€å‘æŒ‡å—

### ä»£ç ç»“æž„

```
mihomoTareAIcopy4.js
â”œâ”€â”€ å¹³å°æ£€æµ‹ (PLATFORM)
â”œâ”€â”€ å¸¸é‡å®šä¹‰ (CONSTANTS)
â”œâ”€â”€ æ—¥å¿—ç³»ç»Ÿ (Logger)
â”œâ”€â”€ å·¥å…·å‡½æ•° (Utils)
â”œâ”€â”€ GitHub é•œåƒç®¡ç†
â”œâ”€â”€ é…ç½®ç®¡ç† (Config)
â”œâ”€â”€ äº‹ä»¶ç³»ç»Ÿ (EventEmitter)
â”œâ”€â”€ ç¼“å­˜ç³»ç»Ÿ (LRUCache)
â”œâ”€â”€ ç»Ÿè®¡æ¨¡å— (RollingStats, SuccessRateTracker)
â”œâ”€â”€ åŒºåŸŸç®¡ç† (RegionAutoManager)
â”œâ”€â”€ å¹¿å‘Šæ‹¦æˆª (AdBlockManager)
â”œâ”€â”€ èŠ‚ç‚¹æ±  (NodePools)
â”œâ”€â”€ ä¸­å¤®ç®¡ç†å™¨ (CentralManager)
â”œâ”€â”€ èŠ‚ç‚¹ç®¡ç†å™¨ (NodeManager)
â”œâ”€â”€ æŒ‡æ ‡ç®¡ç†å™¨ (MetricsManager)
â””â”€â”€ ä¸»å…¥å£ (main)
```

### æ‰©å±•å¼€å‘

#### æ·»åŠ æ–°çš„åœ°ç†ä½ç½®æä¾›è€…

```javascript
// åœ¨ Config.privacy.trustedGeoEndpoints ä¸­æ·»åŠ 
"https://your-geo-api.com/json/{ip}"

// åœ¨ _fetchGeoSeries æ–¹æ³•ä¸­å¤„ç†å“åº”æ ¼å¼
const country = json.country_name || json.country || "Unknown";
const region = json.region || json.city || "Unknown";
```

#### è‡ªå®šä¹‰è¯„åˆ†ç®—æ³•

```javascript
// æ‰©å±• scoreComponents æ–¹æ³•
static scoreComponents(m = {}) {
  // çŽ°æœ‰è¯„åˆ†é€»è¾‘
  const baseScore = // ... çŽ°æœ‰è®¡ç®—
  
  // æ·»åŠ è‡ªå®šä¹‰è¯„åˆ†
  const customScore = yourCustomAlgorithm(m);
  
  return { 
    ...baseScore, 
    customScore,
    metricScore: baseScore.metricScore + customScore 
  };
}
```

#### æ·»åŠ æ–°çš„æœåŠ¡è§„åˆ™

```javascript
// åœ¨ Config.services ä¸­æ·»åŠ 
{
  id: "yourservice",
  rule: ["DOMAIN-SUFFIX,yourservice.com,ä½ çš„æœåŠ¡"],
  name: "ä½ çš„æœåŠ¡",
  url: "https://yourservice.com/health",
  icon: ICON_VAL(ICONS.YourIcon)
}
```

### æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **åˆç†è®¾ç½®å¹¶å‘æ•°**ï¼šæ ¹æ®æœåŠ¡å™¨æ€§èƒ½è°ƒæ•´ `CONCURRENCY_LIMIT`
2. **ä¼˜åŒ–ç¼“å­˜ç­–ç•¥**ï¼šè°ƒæ•´ LRU ç¼“å­˜å¤§å°å’Œ TTL
3. **å‡å°‘å¤–éƒ¨æŸ¥è¯¢**ï¼šå¯ç”¨åœ°ç†ä½ç½®ç¼“å­˜ï¼Œè®¾ç½®åˆç†çš„ TTL
4. **ç›‘æŽ§å†…å­˜ä½¿ç”¨**ï¼šå®šæœŸæ¸…ç†è¿‡æœŸæ•°æ®å’Œç¼“å­˜

### è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æŽ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

## ðŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ðŸ¤ æ”¯æŒ

å¦‚æžœæ‚¨åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼Œè¯·ï¼š

1. æŸ¥çœ‹æœ¬æ–‡æ¡£çš„æ•…éšœæŽ’é™¤éƒ¨åˆ†
2. æ£€æŸ¥ç³»ç»Ÿæ—¥å¿—è¾“å‡º
3. æäº¤ Issue æè¿°é—®é¢˜çŽ°è±¡
4. æä¾›è¯¦ç»†çš„é…ç½®ä¿¡æ¯å’Œé”™è¯¯æ—¥å¿—

---

**æ³¨æ„**ï¼šæœ¬ç³»ç»Ÿä»…ç”¨äºŽå­¦ä¹ å’Œç ”ç©¶ç›®çš„ï¼Œè¯·éµå®ˆå½“åœ°æ³•å¾‹æ³•è§„å’Œç½‘ç»œä½¿ç”¨è§„èŒƒã€‚
